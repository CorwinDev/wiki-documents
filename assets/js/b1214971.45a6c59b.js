"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[53246],{15680:(e,t,n)=>{n.d(t,{xA:()=>g,yg:()=>m});var r=n(96540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},g=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,g=s(e,["components","mdxType","originalType","parentName"]),d=p(n),c=o,m=d["".concat(l,".").concat(c)]||d[c]||u[c]||a;return n?r.createElement(m,i(i({ref:t},g),{},{components:n})):r.createElement(m,i({ref:t},g))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},27601:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=n(9668),o=(n(96540),n(15680));const a={description:"Learn how to install MQTT on the reComputer R1000 and test it with Node-RED. MQTT is a lightweight messaging protocol ideal for IoT applications, enabling efficient, real-time data exchange even over unreliable networks. With Node-RED integration, edge devices and central servers achieve seamless connectivity, optimizing data transmission and processing directly at the edge.",title:"reComputer R1000 with Node Red and MQTT",keywords:["Edge Controller","reComputer R1000","Node-Red","MQTT"],image:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/recomputer-mqtt.png",slug:"/recomputer_r1000_nodered_mqtt",last_update:{date:"07/02/2024",author:"Kasun Thushara"}},i=void 0,s={unversionedId:"Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Node-RED/recomputer-r1000-with-nodered-mqtt",id:"Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Node-RED/recomputer-r1000-with-nodered-mqtt",title:"reComputer R1000 with Node Red and MQTT",description:"Learn how to install MQTT on the reComputer R1000 and test it with Node-RED. MQTT is a lightweight messaging protocol ideal for IoT applications, enabling efficient, real-time data exchange even over unreliable networks. With Node-RED integration, edge devices and central servers achieve seamless connectivity, optimizing data transmission and processing directly at the edge.",source:"@site/docs/Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Node-RED/recomputer-r1000-with-nodered-mqtt.md",sourceDirName:"Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Node-RED",slug:"/recomputer_r1000_nodered_mqtt",permalink:"/recomputer_r1000_nodered_mqtt",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Node-RED/recomputer-r1000-with-nodered-mqtt.md",tags:[],version:"current",lastUpdatedBy:"Kasun Thushara",lastUpdatedAt:1719878400,formattedLastUpdatedAt:"Jul 2, 2024",frontMatter:{description:"Learn how to install MQTT on the reComputer R1000 and test it with Node-RED. MQTT is a lightweight messaging protocol ideal for IoT applications, enabling efficient, real-time data exchange even over unreliable networks. With Node-RED integration, edge devices and central servers achieve seamless connectivity, optimizing data transmission and processing directly at the edge.",title:"reComputer R1000 with Node Red and MQTT",keywords:["Edge Controller","reComputer R1000","Node-Red","MQTT"],image:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/recomputer-mqtt.png",slug:"/recomputer_r1000_nodered_mqtt",last_update:{date:"07/02/2024",author:"Kasun Thushara"}},sidebar:"ProductSidebar",previous:{title:"reComputer-R1000 Getting Started with Node Red",permalink:"/recomputer_r1000_getting_started_node_red"},next:{title:"reComputer R1000 with Node Red and Modbus TCP",permalink:"/recomputer_r1000_node_red_modbus_tcp"}},l={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Getting Start",id:"getting-start",level:2},{value:"Hardware Preparation",id:"hardware-preparation",level:3},{value:"Software Preparation",id:"software-preparation",level:3},{value:"Setup reComputer R1000 as MQTT Broker",id:"setup-recomputer-r1000-as-mqtt-broker",level:2},{value:"Test Connection",id:"test-connection",level:2},{value:"Edit Flows",id:"edit-flows",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],g={toc:p},d="wrapper";function u(e){let{components:t,...n}=e;return(0,o.yg)(d,(0,r.A)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("h2",{id:"introduction"},"Introduction"),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"MQTT (Message Queuing Telemetry Transport)")," is a lightweight messaging protocol ideal for IoT (Internet of Things) applications due to its efficiency and low bandwidth requirements. It facilitates communication between devices in a publish-subscribe model, allowing for real-time data exchange over unreliable networks. With Node-RED, integrating MQTT enables seamless connectivity between edge devices and central servers or other devices, fostering efficient data transmission and processing reComputer R1000 Edge Controller, by supporting MQTT natively, eliminates the need for additional hardware gateways by allowing the installation of an MQTT broker directly on the reComputer R1000 itself. This reduces complexity, minimizes latency, and enhances reliability, as data can be processed and acted upon at the edge without relying on external intermediaries, thus optimizing IoT system architecture."),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/recomputer-mqtt.png",style:{width:800,height:"auto"}})),(0,o.yg)("h2",{id:"getting-start"},"Getting Start"),(0,o.yg)("p",null,"Before you start this project, you may need to prepare your hardware and software in advance as described here."),(0,o.yg)("h3",{id:"hardware-preparation"},"Hardware Preparation"),(0,o.yg)("div",{class:"table-center"},(0,o.yg)("table",{class:"table-nobg"},(0,o.yg)("tr",{class:"table-trnobg"},(0,o.yg)("th",{class:"table-trnobg"},"reComputer R1000")),(0,o.yg)("tr",{class:"table-trnobg"}),(0,o.yg)("tr",{class:"table-trnobg"},(0,o.yg)("td",{class:"table-trnobg"},(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/recomputer_r_images/01.png",style:{width:300,height:"auto"}})))),(0,o.yg)("tr",{class:"table-trnobg"}),(0,o.yg)("tr",{class:"table-trnobg"},(0,o.yg)("td",{class:"table-trnobg"},(0,o.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,o.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/reComputer-R1025-10-p-5895.html"},(0,o.yg)("strong",null,(0,o.yg)("span",null,(0,o.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f"))))))))),(0,o.yg)("h3",{id:"software-preparation"},"Software Preparation"),(0,o.yg)("p",null,"We have prepared a ",(0,o.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/recomputer_r1000_getting_statrted_node_red/"},"Getting started Guide on Node-RED"),". It is recommended that you review this guide before proceeding to the wiki."),(0,o.yg)("h2",{id:"setup-recomputer-r1000-as-mqtt-broker"},"Setup reComputer R1000 as MQTT Broker"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 01")," : SSH or VNC  to reComputer R1000 and Update  Raspberry Pi OS:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"sudo apt update\n")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 02")," : Then, install Mosquitto on it. To do so, open the terminal and execute this command:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"sudo apt-get install mosquitto \n")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 03")," :Next, install the Mosquitto command-line client by executing the following command in the terminal:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"sudo apt-get install mosquitto-clients -y\n")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 04")," : Once the MQTT broker installation is complete, adjustments to its configuration files are necessary. The default configuration file can be found at ",(0,o.yg)("inlineCode",{parentName:"li"},"/etc/mosquitto/mosquitto.conf"),". To access and modify this file, use the nano editor by executing the following command in the terminal:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"sudo nano /etc/mosquitto/mosquitto.conf\n")),(0,o.yg)("p",null,"In the configuration file, we\u2019ll disable the default configuration settings with this line:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"include_dir /etc/mosquitto/conf.d\n")),(0,o.yg)("p",null,"to "),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"#include_dir /etc/mosquitto/conf.d\n")),(0,o.yg)("p",null,"Next, we'll enforce a policy disallowing anonymous users from connecting to the broker by adding the line:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"allow_anonymous false\n")),(0,o.yg)("p",null,"To store passwords securely, we'll specify a file location by adding:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"password_file /etc/mosquitto/pwfile\n")),(0,o.yg)("p",null,"Then, to set the listening port to 1883, we'll add:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"listener 1883\n")),(0,o.yg)("p",null,"Save the modifications by pressing Ctrl+S and exit the editor with Ctrl+X. "),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/mqttconfig.PNG",style:{width:800,height:"auto"}})),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 05")," : To establish usernames and passwords, granting access to MQTT clients, or resetting existing passwords, utilize the following command in the terminal:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"sudo mosquitto_passwd -c /etc/mosquitto/pwfile <username>\n")),(0,o.yg)("p",null,"After generating a username and password, reboot reComputer R1000"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"sudo reboot\n")),(0,o.yg)("p",null,"You can initiate the Mosquitto broker by entering the following command in the terminal:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"sudo systemctl start mosquitto\n")),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"sudo systemctl status mosquitto"),"   To verify whether the Mosquitto broker is running"),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"sudo systemctl stop mosquitto"),"     To halt the Mosquitto broker"),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"sudo systemctl restart mosquitto"),"  For restarting the Mosquitto broker"),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"sudo systemctl enable mosquitto"),"   To ensure that the Mosquitto broker initializes upon system boot"),(0,o.yg)("h2",{id:"test-connection"},"Test Connection"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 01")," : Open a new SSH session or terminal and run the following command to subscribe to a topic")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"mosquitto_sub -h localhost -t test -u <USER> -P <PASSWORD>\n")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 02")," : In another SSH session or terminal, run the following command to publish a message to the same topic. Make sure to enter User name and Password accordingly.")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},'mosquitto_pub -h localhost -t test -m "Hello, world!" -u <USER> -P <PASSWORD>\n')),(0,o.yg)("p",null,'You should see the message "Hello, world!" appear in the first SSH session window where you ran the mosquitto_sub command.  Make sure to enter User name and Password accordingly.'),(0,o.yg)("h2",{id:"edit-flows"},"Edit Flows"),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"MQTT in Node")),(0,o.yg)("p",null,"The MQTT-in node subscribes to MQTT topics and receives messages from the broker. When a message is published to one of its subscribed topics, the MQTT-in node activates and forwards the received message to the subsequent nodes in the flow for further processing."),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 01")," Drag and drop an MQTT-in node from the Node-RED palette onto the canvas.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 02")," Double-click the MQTT-in node to open its configuration dialog.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 03")," In the configuration dialog, configure the following fields:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Server"),": Ensure the broker details are pre-populated. If not, click the pencil icon to add the broker's IP address, username, and password.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Action"),": Select whether to subscribe to a single topic or use a dynamic subscription. For a dynamic subscription, extract the desired MQTT topic from the message payload using a function node or other processing nodes. Here, we'll subscribe to a single topic.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Topic"),": Enter the MQTT topic you want to subscribe to.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"QoS"),": Choose the desired Quality of Service (QoS) level for message delivery (0, 1, or 2).")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Name"),": Optionally, assign a meaningful name to your node.")))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 04")," Click Done to save the configuration."))),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/connection.PNG",style:{width:600,height:"auto"}})),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/mqttin.PNG",style:{width:600,height:"auto"}})),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"MQTT-out Node")," "),(0,o.yg)("p",null,"The MQTT-out node (MQTT output) is used to publish messages to MQTT topics. You can configure the topic and the payload of the message to be published, which can be either static or dynamically generated based on data from other nodes in the flow."),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 01")," Drag and drop an MQTT-out node from the Node-RED palette onto the canvas.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 02")," Double-click the MQTT-out node to open its configuration dialog.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 03")," In the configuration dialog, click the pencil icon next to the Server field to create a new broker configuration.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 04")," Edit the MQTT broker settings by adding the broker\u2019s address in the server field, port, and any authentication credentials if required (e.g., username and password).")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 05")," Click Done to save the broker settings.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Step 06")," In the configuration dialog, configure the following fields:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Topic"),": Enter the MQTT topic to which you want to publish messages.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"QoS"),": Choose the desired Quality of Service (QoS) level for message delivery (0, 1, or 2).")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Retain"),": Choose whether to retain the published message on the broker (true or false).")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Name"),": Optionally, assign a meaningful name to your node."))))),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/mqttout.PNG",style:{width:600,height:"auto"}})),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Step 07")," Click Done to save the configuration.")),(0,o.yg)("p",null,"We use the inject node to inject the message at a certain interval, and we also use the debug node to inspect the published message."),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/debugnode.PNG",style:{width:600,height:"auto"}})),(0,o.yg)("p",null,"You can view this graphical representation below to understand how to connect and configure the MQTT-in, MQTT-out, debug, and inject nodes."),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/nodered/mqtt-edgebox.gif",style:{width:800,height:"auto"}})),(0,o.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,o.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,o.yg)("div",{class:"button_tech_support_container"},(0,o.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,o.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,o.yg)("div",{class:"button_tech_support_container"},(0,o.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,o.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}u.isMDXComponent=!0}}]);