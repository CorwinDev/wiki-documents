"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[64787],{15680:(e,t,o)=>{o.d(t,{xA:()=>u,yg:()=>m});var n=o(96540);function l(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){l(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(e,t){if(null==e)return{};var o,n,l=function(e,t){if(null==e)return{};var o,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(l[o]=e[o]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(l[o]=e[o])}return l}var s=n.createContext({}),d=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):a(a({},t),e)),o},u=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var o=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=d(o),g=l,m=c["".concat(s,".").concat(g)]||c[g]||p[g]||r;return o?n.createElement(m,a(a({ref:t},u),{},{components:o})):n.createElement(m,a({ref:t},u))}));function m(e,t){var o=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=o.length,a=new Array(r);a[0]=g;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:l,a[1]=i;for(var d=2;d<r;d++)a[d]=o[d];return n.createElement.apply(null,a)}return n.createElement.apply(null,o)}g.displayName="MDXCreateElement"},19365:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(96540),l=o(20053);const r={tabItem:"tabItem_Ymn6"};function a(e){let{children:t,hidden:o,className:a}=e;return n.createElement("div",{role:"tabpanel",className:(0,l.A)(r.tabItem,a),hidden:o},t)}},11470:(e,t,o)=>{o.d(t,{A:()=>E});var n=o(58168),l=o(96540),r=o(20053),a=o(23104),i=o(56347),s=o(57485),d=o(31682),u=o(89466);function c(e){return function(e){return l.Children.map(e,(e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:o,attributes:n,default:l}}=e;return{value:t,label:o,attributes:n,default:l}}))}function p(e){const{values:t,children:o}=e;return(0,l.useMemo)((()=>{const e=t??c(o);return function(e){const t=(0,d.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,o])}function g(e){let{value:t,tabValues:o}=e;return o.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:o}=e;const n=(0,i.W6)(),r=function(e){let{queryString:t=!1,groupId:o}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!o)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return o??null}({queryString:t,groupId:o});return[(0,s.aZ)(r),(0,l.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(n.location.search);t.set(r,e),n.replace({...n.location,search:t.toString()})}),[r,n])]}function _(e){const{defaultValue:t,queryString:o=!1,groupId:n}=e,r=p(e),[a,i]=(0,l.useState)((()=>function(e){let{defaultValue:t,tabValues:o}=e;if(0===o.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!g({value:t,tabValues:o}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${o.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=o.find((e=>e.default))??o[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:r}))),[s,d]=m({queryString:o,groupId:n}),[c,_]=function(e){let{groupId:t}=e;const o=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,r]=(0,u.Dv)(o);return[n,(0,l.useCallback)((e=>{o&&r.set(e)}),[o,r])]}({groupId:n}),f=(()=>{const e=s??c;return g({value:e,tabValues:r})?e:null})();(0,l.useLayoutEffect)((()=>{f&&i(f)}),[f]);return{selectedValue:a,selectValue:(0,l.useCallback)((e=>{if(!g({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),_(e)}),[d,_,r]),tabValues:r}}var f=o(92303);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function h(e){let{className:t,block:o,selectedValue:i,selectValue:s,tabValues:d}=e;const u=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),p=e=>{const t=e.currentTarget,o=u.indexOf(t),n=d[o].value;n!==i&&(c(t),s(n))},g=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const o=u.indexOf(e.currentTarget)+1;t=u[o]??u[0];break}case"ArrowLeft":{const o=u.indexOf(e.currentTarget)-1;t=u[o]??u[u.length-1];break}}t?.focus()};return l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":o},t)},d.map((e=>{let{value:t,label:o,attributes:a}=e;return l.createElement("li",(0,n.A)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>u.push(e),onKeyDown:g,onClick:p},a,{className:(0,r.A)("tabs__item",y.tabItem,a?.className,{"tabs__item--active":i===t})}),o??t)})))}function v(e){let{lazy:t,children:o,selectedValue:n}=e;const r=(Array.isArray(o)?o:[o]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===n));return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return l.createElement("div",{className:"margin-top--md"},r.map(((e,t)=>(0,l.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function b(e){const t=_(e);return l.createElement("div",{className:(0,r.A)("tabs-container",y.tabList)},l.createElement(h,(0,n.A)({},e,t)),l.createElement(v,(0,n.A)({},e,t)))}function E(e){const t=(0,f.A)();return l.createElement(b,(0,n.A)({key:String(t)},e))}},63547:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>m,frontMatter:()=>i,metadata:()=>d,toc:()=>c});var n=o(58168),l=(o(96540),o(15680)),r=o(11470),a=o(19365);const i={description:"This wiki demonstrates how to compile a tensorflow model or pytorch model to edge tup model, and run it.",title:"Convert Model to Edge TPU TFlite Format for Google Coral",keywords:["Edge TPU","rpi5","M.2 coral","Tensorflow","Pytorch"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/convert_model_to_edge_tpu_tflite_format_for_google_coral",last_update:{date:"07/23/2024",author:"Jiahao"},no_comments:!1},s="Convert Model to Edge TPU TFlite Format for Google Coral",d={unversionedId:"Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Computer-Vision/convert_model_to_edge_tpu_tflite_format_for_google_coral",id:"Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Computer-Vision/convert_model_to_edge_tpu_tflite_format_for_google_coral",title:"Convert Model to Edge TPU TFlite Format for Google Coral",description:"This wiki demonstrates how to compile a tensorflow model or pytorch model to edge tup model, and run it.",source:"@site/docs/Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Computer-Vision/convert_model_to_edge_tpu_tflite_format_for_google_coral.md",sourceDirName:"Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Computer-Vision",slug:"/convert_model_to_edge_tpu_tflite_format_for_google_coral",permalink:"/convert_model_to_edge_tpu_tflite_format_for_google_coral",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Edge/Raspberry_Pi_Devices/reComputer_R1000/Applications/Computer-Vision/convert_model_to_edge_tpu_tflite_format_for_google_coral.md",tags:[],version:"current",lastUpdatedBy:"Jiahao",lastUpdatedAt:1721692800,formattedLastUpdatedAt:"Jul 23, 2024",frontMatter:{description:"This wiki demonstrates how to compile a tensorflow model or pytorch model to edge tup model, and run it.",title:"Convert Model to Edge TPU TFlite Format for Google Coral",keywords:["Edge TPU","rpi5","M.2 coral","Tensorflow","Pytorch"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/convert_model_to_edge_tpu_tflite_format_for_google_coral",last_update:{date:"07/23/2024",author:"Jiahao"},no_comments:!1},sidebar:"ProductSidebar",previous:{title:"Install M.2 Coral to Raspberry Pi 5",permalink:"/install_m2_coral_to_rpi5"},next:{title:"Pose-Based Light Control with Node-Red and Raspberry Pi with AIkit",permalink:"/pose_based_light_control_with_nodered_and_rpi_with_aikit"}},u={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Prepare Hardware",id:"prepare-hardware",level:2},{value:"Install Hardware",id:"install-hardware",level:2},{value:"Convert Model",id:"convert-model",level:2},{value:"Install Tensorflow",id:"install-tensorflow",level:3},{value:"Check tflite_converter",id:"check-tflite_converter",level:3},{value:"Convert Tensorflow Model to TFlite Model",id:"convert-tensorflow-model-to-tflite-model",level:3},{value:"Convert TFlite Model to Edge TPU Model",id:"convert-tflite-model-to-edge-tpu-model",level:3},{value:"Install edgetpu compiler",id:"install-edgetpu-compiler",level:4},{value:"Transform TFlite Model to Edge TPU Model",id:"transform-tflite-model-to-edge-tpu-model",level:4},{value:"Convert Pytorch model to tflite model",id:"convert-pytorch-model-to-tflite-model",level:3},{value:"Install dependencies",id:"install-dependencies",level:4},{value:"Convert",id:"convert",level:4},{value:"Check tflite_converter",id:"check-tflite_converter-1",level:3},{value:"Convert TFlite Model to Edge TPU Model",id:"convert-tflite-model-to-edge-tpu-model-1",level:3},{value:"Install edgetpu compiler",id:"install-edgetpu-compiler-1",level:4},{value:"Transform TFlite Model to Edge TPU Model",id:"transform-tflite-model-to-edge-tpu-model-1",level:4},{value:"Install Ultralytics",id:"install-ultralytics",level:3},{value:"Convert YOLO Model to egde TPU Model",id:"convert-yolo-model-to-egde-tpu-model",level:3},{value:"You can convert other tflite model to edge TPU model by using the following command:",id:"you-can-convert-other-tflite-model-to-edge-tpu-model-by-using-the-following-command",level:3},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],p={toc:c},g="wrapper";function m(e){let{components:t,...o}=e;return(0,l.yg)(g,(0,n.A)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"convert-model-to-edge-tpu-tflite-format-for-google-coral"},"Convert Model to Edge TPU TFlite Format for Google Coral"),(0,l.yg)("h2",{id:"introduction"},"Introduction"),(0,l.yg)("p",null,"The ",(0,l.yg)("a",{parentName:"p",href:"https://www.seeedstudio.com/Coral-M2-Accelerator-with-Dual-Edge-TPU-p-4681.html"},"Coral M.2 Accelerator")," with Dual Edge TPU is an M.2 module that brings two Edge TPU coprocessors to existing systems and products with an available M.2 E-key slot.",(0,l.yg)("a",{parentName:"p",href:"https://www.tensorflow.org/"},"Tensorflow")," and ",(0,l.yg)("a",{parentName:"p",href:"https://pytorch.org/"},"Pytorch")," is the most popular deep learning frameworks. So in order to use the Edge TPU, we need to compile the model to Edge TPU format."),(0,l.yg)("p",null,"This wiki article will guide you through the process of compiling a model and running it on the Google Coral TPU, enabling you to leverage its capabilities for high-performance machine learning applications."),(0,l.yg)("h2",{id:"prepare-hardware"},"Prepare Hardware"),(0,l.yg)("div",{class:"table-center"},(0,l.yg)("table",{align:"center"},(0,l.yg)("tr",null,(0,l.yg)("th",null,"Raspberry Pi 5 8GB"),(0,l.yg)("th",null,"Raspberry Pi M.2 HAT+"),(0,l.yg)("th",null,"Coral M.2 Accelerator B+M key")),(0,l.yg)("tr",null,(0,l.yg)("td",null,(0,l.yg)("div",{style:{textAlign:"center"}},(0,l.yg)("img",{src:"https://media-cdn.seeedstudio.com/media/catalog/product/cache/bb49d3ec4ee05b6f018e93f896b8a25d/2/-/2-102110919-raspberry-pi-5-8gb-font.jpg",style:{width:600,height:"auto"}}))),(0,l.yg)("td",null,(0,l.yg)("div",{style:{textAlign:"center"}},(0,l.yg)("img",{src:"https://media-cdn.seeedstudio.com/media/catalog/product/cache/bb49d3ec4ee05b6f018e93f896b8a25d/2/-/2-103990663-raspberry-pi-m.2-hat_-_for-raspberry-pi-5_-font.jpg",style:{width:600,height:"auto"}}))),(0,l.yg)("td",null,(0,l.yg)("div",{style:{textAlign:"center"}},(0,l.yg)("img",{src:"https://media-cdn.seeedstudio.com/media/catalog/product/cache/bb49d3ec4ee05b6f018e93f896b8a25d/1/1/114992124-front.jpg",style:{width:600,height:"auto"}})))),(0,l.yg)("tr",null,(0,l.yg)("td",null,(0,l.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,l.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Raspberry-Pi-5-8GB-p-5810.html"},(0,l.yg)("strong",null,(0,l.yg)("span",null,(0,l.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,l.yg)("td",null,(0,l.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,l.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Raspberry-Pi-M-2-HAT-for-Raspberry-Pi-5-p-5881.html"},(0,l.yg)("strong",null,(0,l.yg)("span",null,(0,l.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,l.yg)("td",null,(0,l.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,l.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Coral-M-2-Accelerator-B-M-key-p-4411.html"},(0,l.yg)("strong",null,(0,l.yg)("span",null,(0,l.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f"))))))))),(0,l.yg)("h2",{id:"install-hardware"},"Install Hardware"),(0,l.yg)("p",{style:{textAlign:"center"}},(0,l.yg)("img",{src:"https://files.seeedstudio.com/wiki/reComputer-R1000/YOLOV8/pycoral_install.gif",alt:"pir",width:1e3,height:"auto"})),(0,l.yg)("h2",{id:"convert-model"},"Convert Model"),(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},"Before you start, make sure you have installed the Google Coral TPU to Pi 5 follow the ",(0,l.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/install_m2_coral_to_rpi5/"},"installation guide"),". ")),(0,l.yg)(r.A,{mdxType:"Tabs"},(0,l.yg)(a.A,{value:"Method 1",label:"For Tensorflow Model",mdxType:"TabItem"},(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},"And all process have been tested on Python 3.11.9. ")),(0,l.yg)("h3",{id:"install-tensorflow"},"Install Tensorflow"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"pip install tensorflow\n")),(0,l.yg)("h3",{id:"check-tflite_converter"},"Check tflite_converter"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"tflite_convert -h\n")),(0,l.yg)("p",null,"The result should be like this:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},'2024-07-23 10:41:03.750087: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2024-07-23 10:41:04.276520: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nusage: tflite_convert [-h] --output_file OUTPUT_FILE [--saved_model_dir SAVED_MODEL_DIR | --keras_model_file KERAS_MODEL_FILE] [--saved_model_tag_set SAVED_MODEL_TAG_SET]\n                      [--saved_model_signature_key SAVED_MODEL_SIGNATURE_KEY] [--enable_v1_converter] [--experimental_new_converter [EXPERIMENTAL_NEW_CONVERTER]]\n                      [--experimental_new_quantizer [EXPERIMENTAL_NEW_QUANTIZER]]\n\nCommand line tool to run TensorFlow Lite Converter.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --output_file OUTPUT_FILE\n                        Full filepath of the output file.\n  --saved_model_dir SAVED_MODEL_DIR\n                        Full path of the directory containing the SavedModel.\n  --keras_model_file KERAS_MODEL_FILE\n                        Full filepath of HDF5 file containing tf.Keras model.\n  --saved_model_tag_set SAVED_MODEL_TAG_SET\n                        Comma-separated set of tags identifying the MetaGraphDef within the SavedModel to analyze. All tags must be present. In order to pass in an empty tag set, pass in "". (default "serve")\n  --saved_model_signature_key SAVED_MODEL_SIGNATURE_KEY\n                        Key identifying the SignatureDef containing inputs and outputs. (default DEFAULT_SERVING_SIGNATURE_DEF_KEY)\n  --enable_v1_converter\n                        Enables the TensorFlow V1 converter in 2.0\n  --experimental_new_converter [EXPERIMENTAL_NEW_CONVERTER]\n                        Experimental flag, subject to change. Enables MLIR-based conversion instead of TOCO conversion. (default True)\n  --experimental_new_quantizer [EXPERIMENTAL_NEW_QUANTIZER]\n                        Experimental flag, subject to change. Enables MLIR-based quantizer instead of flatbuffer conversion. (default True)\n\n')),(0,l.yg)("h3",{id:"convert-tensorflow-model-to-tflite-model"},"Convert Tensorflow Model to TFlite Model"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"tflite_convert --saved_model_dir=YOUR_MODEL_PATH --output_file=YOUR_MODEL_NAME.tflite\n")),(0,l.yg)("h3",{id:"convert-tflite-model-to-edge-tpu-model"},"Convert TFlite Model to Edge TPU Model"),(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},"You should optimize your model before you convert tflite model to edge tup model, please check the ",(0,l.yg)("a",{parentName:"p",href:"https://www.tensorflow.org/lite/performance/model_optimization"},"Optimize Tensorflow Model"))),(0,l.yg)("h4",{id:"install-edgetpu-compiler"},"Install edgetpu compiler"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},'curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -\n\necho "deb https://packages.cloud.google.com/apt coral-edgetpu-stable main" | sudo tee /etc/apt/sources.list.d/coral-edgetpu.list\n\nsudo apt-get update\n\nsudo apt-get install edgetpu-compiler\n')),(0,l.yg)("h4",{id:"transform-tflite-model-to-edge-tpu-model"},"Transform TFlite Model to Edge TPU Model"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"edgetpu_compiler YOUR_MODEL_NAME.tflite\n")),(0,l.yg)("p",null,"And then you should get a new file named ",(0,l.yg)("inlineCode",{parentName:"p"},"YOUR_MODEL_NAME_edgetpu.tflite"))),(0,l.yg)(a.A,{value:"Method 2",label:"For Pytorch Model",mdxType:"TabItem"},(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},"We do not recommend this approach because there are many conflicting packages in the actual process. And TensorFlow Lite supports a limited set of operations, some PyTorch operations may not be supported.  ")),(0,l.yg)("h3",{id:"convert-pytorch-model-to-tflite-model"},"Convert Pytorch model to tflite model"),(0,l.yg)("h4",{id:"install-dependencies"},"Install dependencies"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"pip install -r https://github.com/google-ai-edge/ai-edge-torch/releases/download/v0.1.1/requirements.txt\npip install ai-edge-torch==0.1.1\n")),(0,l.yg)("h4",{id:"convert"},"Convert"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"import ai_edge_torch\nimport numpy\nimport torch\nimport torchvision\n\n\nresnet18 = torchvision.models.resnet18(torchvision.models.ResNet18_Weights.IMAGENET1K_V1).eval()\nsample_inputs = (torch.randn(1, 3, 224, 224),)\ntorch_output = resnet18(*sample_inputs)\n\nedge_model = ai_edge_torch.convert(resnet18.eval(), sample_inputs)\n\nedge_model.export('resnet.tflite')\n")),(0,l.yg)("p",null,"You will get ",(0,l.yg)("inlineCode",{parentName:"p"},"resnet.tflite")," "),(0,l.yg)("h3",{id:"check-tflite_converter-1"},"Check tflite_converter"),(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},"You should optimize your model before you convert tflite model to edge tup model, please check the ",(0,l.yg)("a",{parentName:"p",href:"https://www.tensorflow.org/lite/performance/model_optimization"},"Optimize Tensorflow Model"))),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"tflite_convert -h\n")),(0,l.yg)("p",null,"The result should be like this:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},'2024-07-23 10:41:03.750087: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2024-07-23 10:41:04.276520: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nusage: tflite_convert [-h] --output_file OUTPUT_FILE [--saved_model_dir SAVED_MODEL_DIR | --keras_model_file KERAS_MODEL_FILE] [--saved_model_tag_set SAVED_MODEL_TAG_SET]\n                      [--saved_model_signature_key SAVED_MODEL_SIGNATURE_KEY] [--enable_v1_converter] [--experimental_new_converter [EXPERIMENTAL_NEW_CONVERTER]]\n                      [--experimental_new_quantizer [EXPERIMENTAL_NEW_QUANTIZER]]\n\nCommand line tool to run TensorFlow Lite Converter.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --output_file OUTPUT_FILE\n                        Full filepath of the output file.\n  --saved_model_dir SAVED_MODEL_DIR\n                        Full path of the directory containing the SavedModel.\n  --keras_model_file KERAS_MODEL_FILE\n                        Full filepath of HDF5 file containing tf.Keras model.\n  --saved_model_tag_set SAVED_MODEL_TAG_SET\n                        Comma-separated set of tags identifying the MetaGraphDef within the SavedModel to analyze. All tags must be present. In order to pass in an empty tag set, pass in "". (default "serve")\n  --saved_model_signature_key SAVED_MODEL_SIGNATURE_KEY\n                        Key identifying the SignatureDef containing inputs and outputs. (default DEFAULT_SERVING_SIGNATURE_DEF_KEY)\n  --enable_v1_converter\n                        Enables the TensorFlow V1 converter in 2.0\n  --experimental_new_converter [EXPERIMENTAL_NEW_CONVERTER]\n                        Experimental flag, subject to change. Enables MLIR-based conversion instead of TOCO conversion. (default True)\n  --experimental_new_quantizer [EXPERIMENTAL_NEW_QUANTIZER]\n                        Experimental flag, subject to change. Enables MLIR-based quantizer instead of flatbuffer conversion. (default True)\n\n')),(0,l.yg)("h3",{id:"convert-tflite-model-to-edge-tpu-model-1"},"Convert TFlite Model to Edge TPU Model"),(0,l.yg)("h4",{id:"install-edgetpu-compiler-1"},"Install edgetpu compiler"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},'curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -\n\necho "deb https://packages.cloud.google.com/apt coral-edgetpu-stable main" | sudo tee /etc/apt/sources.list.d/coral-edgetpu.list\n\nsudo apt-get update\n\nsudo apt-get install edgetpu-compiler\n')),(0,l.yg)("h4",{id:"transform-tflite-model-to-edge-tpu-model-1"},"Transform TFlite Model to Edge TPU Model"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"edgetpu_compiler resnet18.tflite\n")),(0,l.yg)("p",null,"And then you should get a new file named ",(0,l.yg)("inlineCode",{parentName:"p"},"resnet18_edgetpu.tflite"))),(0,l.yg)(a.A,{value:"Method 3",label:"For Yolo Model",mdxType:"TabItem"},(0,l.yg)("h3",{id:"install-ultralytics"},"Install Ultralytics"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"pip install ultralytics \n")),(0,l.yg)("h3",{id:"convert-yolo-model-to-egde-tpu-model"},"Convert YOLO Model to egde TPU Model"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# For example, if you want to convert yolov8n.pt to yolov8n_integer_quant_edgetpu.tflite\n\nyolo export model=yolov8n.pt format=edge int8=True\n\n")),(0,l.yg)("p",null,"The result should be like this:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"jiahao@PC:~/yolov8s_saved_model$ ls\nassets          saved_model.pb          yolov8s_float32.tflite                     yolov8s_full_integer_quant.tflite\nfingerprint.pb  variables               yolov8s_full_integer_quant_edgetpu.log     yolov8s_int8.tflite\nmetadata.yaml   yolov8s_float16.tflite  yolov8s_full_integer_quant_edgetpu.tflite  yolov8s_integer_quant.tflite\n")),(0,l.yg)("p",null,"The ",(0,l.yg)("inlineCode",{parentName:"p"},"yolov8s_full_integer_quant_edgetpu.tflite")," is the model you need."),(0,l.yg)("h3",{id:"you-can-convert-other-tflite-model-to-edge-tpu-model-by-using-the-following-command"},"You can convert other tflite model to edge TPU model by using the following command:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# For example, you can convert yolov8s_int8.tflite to edge TPU model\nedgetpu_compiler yolov8s_int8.tflite\n\n")))),(0,l.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,l.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,l.yg)("div",{class:"button_tech_support_container"},(0,l.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,l.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,l.yg)("div",{class:"button_tech_support_container"},(0,l.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,l.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}m.isMDXComponent=!0}}]);